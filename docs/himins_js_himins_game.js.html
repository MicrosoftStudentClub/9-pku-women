<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: himins_js/himins_game.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: himins_js/himins_game.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @fileOverview Manages a game object from a himins game JSON file
 * @module
 * @requires fs
 * @requires underscore
 * @requires ./himins_js/himins_room
 * @requires ./himins_js/himins_player
 * @requires ./himins_js/himins_commands
 * @requires ./himins_js/himins_repl
 * @requires ./himins_js/himins_format
 * @requires ./himins_js/himins_file_utils
 */

// ## includes
var
  // ### Node modules
  fs = require('fs'),

  // ### 3rd party modules
  _ = require('underscore'),

  // ### Himins modules
  commands = require('./himins_commands'),
  room = require('./himins_room'),
  files = require('./himins_file_utils'),
  repl = require('./himins_repl'),
  format = require('./himins_format'),
  player = require('./himins_player'),
  game = require('./himins_game');

// ## module vars
var
  roomList = [];

//# init(gameObject)
var init = function(gameObject) {
  console.log('*** himins_game.js init(', gameObject.name, ')');

  // load the rooms

  _.each(gameObject.roomFiles, function(e, i, l) {
    files.loadJSON('himins_json/' + e, function(resultObject) {
      room.init(resultObject);
      gameObject.rooms.push(resultObject);
    });

  });
};
module.exports.init = init;

var getRoomByName = function(gameObject, roomName) {

  var result = _.find(gameObject.rooms, function(room) {
    return room.name.toLowerCase() === roomName.toLowerCase();
  });

  return result;
};
module.exports.getRoomByName = getRoomByName;

// # start(playerObject)
var start = function(playerObject) {
  var
    roomObject = {},
    sectionObject = {},
    gameObject = {},
    artFileURI = '';

  // add commands that only make sense once the game is started

  commands.addCommand(playerObject.commands, {
    name: 'look',
    description: '!SECTION_DESCRIPTION',
    action: '!NO_ACTION',
    kind: 'game' }
  );

  commands.addCommand(playerObject.commands, {
    name: 'where',
    description: '_himins_ reports that you are in the _!PLAYER_LOCATION_ of the *!ROOM_NAME*',
    action: '!NO_ACTION',
    kind: 'game' }
  );

  //TODO: refactor to player.moveToRoom()

  // set the location of the player
  gameObject = playerObject.game;
  playerObject.roomName = gameObject.startRoom;
  roomObject = game.getRoomByName(gameObject, gameObject.startRoom);
  playerObject.sectionName = roomObject.spawnSection;

  artFileURI = './himins_txt/' + roomObject.artFileName;

  files.loadTEXT(artFileURI, function(resultObject) {
    playerObject.client.write(resultObject + '\n');

    // do the spawn stuff based on player's location
    player.enterRoom(playerObject, roomObject);
    sectionObject = room.getSectionByName(roomObject, playerObject.sectionName);
    player.enterSection(playerObject, sectionObject);
  });
};
module.exports.start = start;

</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="experiments_main.module_js.html">experiments/main.js</a></li><li><a href="himins_app.module_js.html">himins_app.js</a></li><li><a href="himins_js_himins_client.module_js.html">himins_js/himins_client.js</a></li><li><a href="himins_js_himins_commands.module_js.html">himins_js/himins_commands.js</a></li><li><a href="himins_js_himins_file_utils.module_js.html">himins_js/himins_file_utils.js</a></li><li><a href="himins_js_himins_format.module_js.html">himins_js/himins_format.js</a></li><li><a href="himins_js_himins_game.module_js.html">himins_js/himins_game.js</a></li><li><a href="himins_js_himins_player.module_js.html">himins_js/himins_player.js</a></li><li><a href="himins_js_himins_repl.module_js.html">himins_js/himins_repl.js</a></li><li><a href="himins_js_himins_room.module_js.html">himins_js/himins_room.js</a></li><li><a href="himins_js_himins_string_utils.module_js.html">himins_js/himins_string_utils.js</a></li><li><a href="test_himins_client_tests.module_js.html">test/himins_client_tests.js</a></li><li><a href="test_main_tests.module_js.html">test/main_tests.js</a></li></ul><h3>Classes</h3><ul><li><a href="experiments_main.module_js-Player.html">Player</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.2</a> on Tue Jul 07 2015 23:42:19 GMT-0400 (EDT)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
